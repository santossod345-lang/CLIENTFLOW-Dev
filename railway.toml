[build]
builder = "dockerfile"
dockerfilePath = "Dockerfile"

[deploy]
startCommand = "/bin/sh -c \"gunicorn backend.main:app -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:${PORT:-8000} --workers 2 --timeout 120 --access-logfile - --error-logfile -\""
restartPolicyMaxRetries = 5
restartPolicyWindowSeconds = 600

[env]
PYTHONUNBUFFERED = "1"
PYTHONDONTWRITEBYTECODE = "1"
ENVIRONMENT = "production"
LOG_LEVEL = "info"

[[services]]
name = "ClientFlow-Backend"
runtime = "dockerfile"
processType = "web"
cpuLimit = "500m"
memoryLimit = "512Mi"

[[databases]]
name = "PostgreSQL"
image = "postgres:15"
version = "15"
port = 5432
